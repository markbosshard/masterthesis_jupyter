{"files":[{"id":"0dd664ea-ef6b-4410-a1d0-819f8cef43f4","name":"Code","type":"server_js","source":"var arg1;\nvar arg2;\nfunction CreateFormfromSheet(arg1,arg2){\n var now\u003d new Date();\n \n var sheet\u003d SpreadsheetApp.openById(arg2); \n\n var range \u003d sheet.getDataRange(); \n var data \u003d range.getValues();\n var numberRows \u003d range.getNumRows();\n var numberColumns \u003d range.getNumColumns();\n var firstRow \u003d 1;\n  var form \u003d FormApp.create(data[0][1]+now.getTime());\n  \n  var url\u003dform.getEditUrl();\n form.setDescription(data[1][1]);\n form.requiresLogin();\n \n for(var m\u003d0;m\u003carg1.length;m++)\n {\n  for(var i\u003d0;i\u003cnumberRows;i++){\n  var questionType \u003d data[i][0]; \n  if (questionType\u003d\u003d\u0027\u0027){\n     continue;\n  }  \n  else if(questionType\u003d\u003darg1[m]){\n  var currentRow \u003d firstRow+i;\n  var getSheetRange \u003d sheet.getDataRange().getLastColumn();\n  var range_string \u003d \u0027D\u0027 + currentRow + \":\" + getSheetRange + currentRow;\n  var optionsArray \u003d sheet.getRange(range_string).getValues();  \n  var choicesForQuestion \u003d[];\n    for (var j\u003d0;j\u003coptionsArray[0].length;j++){\n      if (optionsArray[0][j] !\u003d\u003d \"\") {\n        choicesForQuestion.push(optionsArray[0][j]);\n        }\n      }\n  form.addMultipleChoiceItem()\n    .setTitle(data[i][1])\n    .setHelpText(data[i][2])\n    .setChoiceValues(choicesForQuestion)\n    .setRequired(true); \n  }\n  \n }\n  \n}\n  form.setLimitOneResponsePerUser(true);\n  return url;\n}\n"}]}